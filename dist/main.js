(()=>{"use strict";var t,o=function(){function t(){this.canvas=document.getElementById("game")}return t.prototype.setup=function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,t.width=this.canvas.width,t.height=this.canvas.height,t.ctx=this.canvas.getContext("2d")},t}(),n=function(){function t(){}return t.prototype.handleInput=function(){document.addEventListener("keydown",(function(o){t.keys[o.code]=!0})),document.addEventListener("keyup",(function(o){t.keys[o.code]=!1}))},t.keys={},t}(),e=function(t,o,n,e){this.x=t,this.y=o,this.w=n,this.h=e},r=(t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)},function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),i=function(t){function n(o,n,e,r,i){var c=t.call(this,n,e,r,i)||this;return c.img=new Image,c.urlImg=o,c.img.src=o,c}return r(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.drawImage(this.img,this.x,this.y,this.w,this.h),o.ctx.closePath()},n.prototype.update=function(){},n}(e),c=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),s=function(t){function n(o,n,e,r,i,c){var s=t.call(this,n,e,0,0)||this;return s.t=o,s.a=r,s.c=i,s.s=c,s}return c(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.fillStyle=this.c,o.ctx.font=this.s+"px sans-serif",o.ctx.textAlign=this.a,o.ctx.fillText(this.t,this.x,this.y),o.ctx.closePath()},n}(e),u=function(){function t(){}return t.prototype.render=function(t){var o=this;t.objectList.forEach((function(t){t instanceof i?o.renderImage(t):t instanceof s&&o.renderText(t)}))},t.prototype.renderImage=function(t){t.draw()},t.prototype.renderText=function(t){t.draw()},t}(),p=function(){function t(){}return t.prototype.addScene=function(o){t.scenes.push(o),1==t.scenes.length&&(t.currentScene=o)},t.prototype.findSceneIndex=function(o){return t.scenes.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(o)}))},t.scenes=[],t}(),a=function(){function t(){this.sceneManager=new p}return t.prototype.addScene=function(t){console.log("Game: addScene"),this.sceneManager.addScene(t)},t.prototype.start=function(){},t}(),h=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),l=function(t){function o(){var o=t.call(this)||this;return o.render=new u,o}return h(o,t),o.prototype.addScene=function(o){t.prototype.addScene.call(this,o)},o.prototype.start=function(){var t=this,o=window.performance.now(),n=window.performance.now()-this.lastTime;this.lastTime=o;var e=p.currentScene;e.update(o,n),this.render.render(e),requestAnimationFrame((function(){t.start()}))},o}(a),f=function(){function t(){}return t.prototype.update=function(t,o){},t}(),y=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),d=function(t){function e(o,n,e,r){var i=t.call(this,"./img/trex-1.png",o,n,e,r)||this;return i.image=new Image,i.originalHeight=i.h,i.originalWeight=i.w,i.grounded=!1,i.ground=54,i.jumpForce=15,i.jumpTimer=0,i.isBow=!1,i.dy=0,i.gravity=1,i}return y(e,t),e.prototype.draw=function(){o.ctx.beginPath(),0==this.isBow?(this.urlImg="./img/trex-1.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)):(this.urlImg="./img/trex-2.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)),o.ctx.closePath()},e.prototype.update=function(){n.keys.Space||n.keys.KeyW||n.keys.ArrowUp?this.jump():this.jumpTimer=0,n.keys.ArrowDown||n.keys.KeyS?(this.isBow=!0,this.h=3*this.originalHeight/4):(this.isBow=!1,this.h=this.originalHeight,this.w=this.originalWeight),this.y+=this.dy,this.y+this.h<o.height-this.ground?(this.dy+=this.gravity,this.grounded=!1):(this.dy=0,this.grounded=!0,this.y=o.height-this.h-this.ground),this.draw()},e.prototype.jump=function(){o.ctx.clearRect(this.x,this.y,this.w,this.h),this.grounded&&0==this.jumpTimer?(this.jumpTimer=1,this.dy=-this.jumpForce):this.jumpTimer>0&&this.jumpTimer<15&&(this.jumpTimer++,this.dy=-this.jumpForce-this.jumpTimer/50)},e}(i),w=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),g=function(t){function o(o,n,e,r){var i=t.call(this,"./img/cactus.png",o,n,e,r)||this;return i.dx=-10,i}return w(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(i),_=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),m=function(t){function o(o,n,e,r){var i=t.call(this,"./img/brid.png",o,n,e,r)||this;return i.dx=-10,i}return _(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(i),x=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),O=function(t){function o(o,n,e,r){var i=t.call(this,"./img/cloud.png",o,n,e,r)||this;return i.dx=-20,i}return x(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(i),b=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),v=function(t){function o(o,n,e){return t.call(this,o,n,e,"left","#212121","20")||this}return b(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(s),j=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),T=function(t){function o(o,n,e){return t.call(this,o,n,e,"center","black","30")||this}return j(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(s),S=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),P=function(t){function o(o,n,e,r){var i=t.call(this,"./img/ground.png",o,n,e,r)||this;return i.dx=-1,i}return S(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(i),A=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),E=function(t){function o(o,n,e,r){var i=t.call(this,"./img/gameOver.png",o,n,e,r)||this;return i.dx=-10,i}return A(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.draw()},o}(i),I=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),L=function(t){function e(){var n=t.call(this)||this;return n.objectList=[],n.startText=new T("PRESS SPACE TO START GAME",o.width/2+45,o.height/2-20),n.scoreText=new v("Score: 0",25,25),n.highscore=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new v("Highscore: "+n.highscore,o.width-200,25),n.player=new d(25,o.height-150,100,100),n.ground=new P(0,o.height-54,o.width,10),n.objectList.push(n.startText),n.objectList.push(n.scoreText),n.objectList.push(n.highscoreText),n.objectList.push(n.player),n.objectList.push(n.ground),n}return I(e,t),e.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),p.currentScene=new k)},e}(f),C=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),k=function(t){function n(){var n=t.call(this)||this;return n.objectList=[],n.initialSpawnTimer=200,n.spawnTimer=n.initialSpawnTimer,n.isDead=!1,n.clouds=[],n.obstacles=[],n.scoreText=new v("Score: 0",25,25),n.highscore=0,n.score=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new v("Highscore: "+n.highscore,o.width-200,25),n.player=new d(25,o.height-150,100,100),n.ground=new P(0,o.height-54,o.width,10),n.cactus=new g(4e3,4e3,50,120),n.brid=new m(4e3,4e3,120,70),n.cloud=new O(4e3,2e3,120,70),n.gameSpeed=10,n.objectList.push(n.scoreText),n.objectList.push(n.highscoreText),n.objectList.push(n.player),n.objectList.push(n.ground),n.objectList.push(n.cactus),n.objectList.push(n.brid),n.objectList.push(n.cloud),n}return C(n,t),n.prototype.swapCloud=function(){this.cloud=new O(o.width,o.height-300,120,70),this.clouds.push(this.cloud)},n.prototype.swapObstacle=function(){0==this.random(0,2)?(this.brid=new m(o.width+50,o.height-200,120,70),this.obstacles.push(this.brid)):(this.cactus=new g(o.width+50,o.height-170,50,120),this.obstacles.push(this.cactus))},n.prototype.random=function(t,o){return Math.round(Math.random()*(o-t)+t)},n.prototype.update=function(t,n){o.ctx.clearRect(0,0,o.width,o.height),this.score++,this.scoreText.t="Score: "+this.score,this.score>this.highscore&&(this.highscore=this.score,this.highscoreText.t="Highscore: "+this.highscore),this.scoreText.draw(),this.highscoreText.draw(),this.spawnTimer--,this.spawnTimer<=0&&(this.swapCloud(),this.swapObstacle(),this.spawnTimer=this.initialSpawnTimer-12,this.spawnTimer<60&&(this.spawnTimer=60));for(var e=0;e<this.clouds.length;e++)(r=this.clouds[e]).x+r.w<0&&this.clouds.slice(e,1),r.update();for(e=0;e<this.obstacles.length;e++){var r;console.log(),(r=this.obstacles[e]).x+r.w<0&&(console.log(1),this.obstacles.splice(e,1)),console.log("---------------------"),console.log(this.player.x),console.log(this.player.w),console.log(r.w),console.log(this.player.x<r.x+r.w),this.player.x<r.x+r.w&&this.player.x+this.player.w>r.x&&this.player.y<r.y+r.h&&this.player.y+this.player.h>r.y&&(this.obstacles=[],this.score=0,this.spawnTimer=this.initialSpawnTimer,this.gameSpeed=10,p.currentScene=new H),r.update()}this.player.update()},n}(f),B=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),H=function(t){function e(){var n=t.call(this)||this;return n.objectList=[],n.gameOverText=new T("Game Over",o.width/2+10,o.height/2-70),n.gameOverButton=new E(o.width/2-50,o.height/2-50,100,100),n.objectList.push(n.gameOverButton),n.objectList.push(n.gameOverText),n}return B(e,t),e.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),p.currentScene=new k)},e}(f);(new o).setup(),(new n).handleInput();var M=new l;console.log("Start"),M.addScene(new L),M.addScene(new k),M.addScene(new H),M.start()})();