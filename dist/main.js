(()=>{"use strict";var t,e=function(t,e,n,r){this.x=t,this.y=e,this.w=n,this.h=r},n=(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=function(t){function e(e,n,r,o,i){var c=t.call(this,n,r,o,i)||this;return c.urlImg=e,c}return n(e,t),e.prototype.update=function(){},e}(e),o=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(t){function e(e,n,r,o,i,c){var s=t.call(this,n,r,0,0)||this;return s.t=e,s.a=o,s.c=i,s.s=c,s}return o(e,t),e}(e),c=function(){function t(t){this.configs=t,this.canvas=document.getElementById(t.canvasId),this.canvas.width=this.configs.width,this.canvas.height=this.configs.height,this.ctx=this.canvas.getContext("2d")}return t.prototype.render=function(t){var e=this;t.objectList.forEach((function(t){t instanceof r?e.renderImage(t):t instanceof i&&e.renderText(t)}))},t.prototype.renderImage=function(t){var e=t.urlImg,n=t.x,r=t.y,o=t.w,i=t.h,c=new Image;c.src=e,this.ctx.beginPath(),this.ctx.drawImage(c,n,r,o,i),this.ctx.closePath()},t.prototype.renderText=function(t){var e=t.t,n=t.x,r=t.y,o=t.a,i=t.c,c=t.s;this.ctx.beginPath(),this.ctx.fillStyle=i,this.ctx.font=c+"px sans-serif",this.ctx.textAlign=o,this.ctx.fillText(e,n,r),this.ctx.closePath()},t}(),s=function(){function t(){}return t.prototype.handleInput=function(){document.addEventListener("keydown",(function(e){t.keys[e.code]=!0})),document.addEventListener("keyup",(function(e){t.keys[e.code]=!1}))},t.keys={},t}(),u=function(){function t(){}return t.prototype.addScene=function(e){t.scenes.push(e),1==t.scenes.length&&(t.currentScene=e)},t.prototype.findSceneIndex=function(e){return t.scenes.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(e)}))},t.scenes=[],t}(),h=function(){function t(t){this.sceneManager=new u,this.configs=t,this.renderer=new c(t)}return t.prototype.addScene=function(t){this.sceneManager.addScene(t)},t.prototype.start=function(){var t=this,e=window.performance.now(),n=window.performance.now()-this.lastTime;this.lastTime=e;var r=u.currentScene;this.renderer.render(r),r.update(e,n),requestAnimationFrame((function(){t.start()}))},t}(),p=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(e){return t.call(this,e)||this}return p(e,t),e.prototype.addScene=function(e){t.prototype.addScene.call(this,e)},e.prototype.start=function(){t.prototype.start.call(this)},e}(h),f=function(){function t(t){this.configs=t,this.renderer=new c(t)}return t.prototype.update=function(t,e){},t}(),l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(e,n,r,o){var i=t.call(this,"./img/trex-1.png",e,n,r,o)||this;return i.image=new Image,i.originalHeight=i.h,i.originalWeight=i.w,i.grounded=!1,i.ground=54,i.jumpForce=15,i.jumpTimer=0,i.isBow=!1,i.dy=0,i.gravity=1,i}return l(e,t),e.prototype.draw=function(){0==this.isBow?this.urlImg="./img/trex-1.png":this.urlImg="./img/trex-2.png"},e.prototype.update=function(){s.keys.Space||s.keys.KeyW||s.keys.ArrowUp?this.jump():this.jumpTimer=0,s.keys.ArrowDown||s.keys.KeyS?(this.isBow=!0,this.h=3*this.originalHeight/4):(this.isBow=!1,this.h=this.originalHeight,this.w=this.originalWeight),this.y+=this.dy,this.y+this.h<innerHeight-this.ground?(this.dy+=this.gravity,this.grounded=!1):(this.dy=0,this.grounded=!0,this.y=innerHeight-this.h-this.ground)},e.prototype.jump=function(){this.grounded&&0==this.jumpTimer?(this.jumpTimer=1,this.dy=-this.jumpForce):this.jumpTimer>0&&this.jumpTimer<15&&(this.jumpTimer++,this.dy=-this.jumpForce-this.jumpTimer/50)},e}(r),d=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(e,n,r,o){var i=t.call(this,"./img/cactus.png",e,n,r,o)||this;return i.dx=-10,i}return d(e,t),e.prototype.update=function(){this.x+=this.dx},e}(r),w=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(t){function e(e,n,r,o){var i=t.call(this,"./img/brid.png",e,n,r,o)||this;return i.dx=-10,i}return w(e,t),e.prototype.update=function(){this.x+=this.dx},e}(r),m=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(t){function e(e,n,r,o){var i=t.call(this,"./img/cloud.png",e,n,r,o)||this;return i.dx=-20,i}return m(e,t),e.prototype.update=function(){this.x+=this.dx},e}(r),b=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(t){function e(e,n,r){return t.call(this,e,n,r,"left","#212121","20")||this}return b(e,t),e}(i),v=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(t){function e(e,n,r){return t.call(this,e,n,r,"center","black","30")||this}return v(e,t),e}(i),T=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function e(e,n,r,o){var i=t.call(this,"./img/ground.png",e,n,r,o)||this;return i.dx=-1,i}return T(e,t),e.prototype.update=function(){this.x+=this.dx},e}(r),P=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(t){function e(e,n,r,o){var i=t.call(this,"./img/gameOver.png",e,n,r,o)||this;return i.dx=-10,i}return P(e,t),e.prototype.update=function(){},e}(r),A=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(t){function e(e){var n=t.call(this,e)||this;return n.objectList=[],n.startText=new j("PRESS SPACE TO START GAME",n.renderer.configs.width/2+45,n.renderer.configs.height/2-20),n.scoreText=new x("Score: 0",25,25),n.highscore=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new x("Highscore: "+n.highscore,n.renderer.configs.width-200,25),n.player=new y(25,n.renderer.configs.height-150,100,100),n.ground=new S(0,n.renderer.configs.height-54,n.renderer.configs.width,10),n.objectList.push(n.startText),n.objectList.push(n.scoreText),n.objectList.push(n.highscoreText),n.objectList.push(n.player),n.objectList.push(n.ground),n}return A(e,t),e.prototype.update=function(t,e){s.keys.Space&&(console.log("Space"),u.currentScene=new C(this.configs))},e}(f),L=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(t){function e(e){var n=t.call(this,e)||this;return n.objectList=[],n.initialSpawnTimer=200,n.spawnTimer=n.initialSpawnTimer,n.isDead=!1,n.clouds=[],n.obstacles=[],n.scoreText=new x("Score: 0",25,25),n.highscore=0,n.score=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new x("Highscore: "+n.highscore,n.renderer.configs.width-200,25),n.player=new y(25,n.renderer.configs.height-150,100,100),n.ground=new S(0,n.renderer.configs.height-54,n.renderer.configs.width,10),n.cactus=new g(4e3,4e3,50,120),n.brid=new _(4e3,4e3,120,70),n.cloud=new O(4e3,2e3,120,70),n.gameSpeed=10,n.objectList.push(n.scoreText),n.objectList.push(n.highscoreText),n.objectList.push(n.player),n.objectList.push(n.ground),n.objectList.push(n.cactus),n.objectList.push(n.brid),n.objectList.push(n.cloud),n}return L(e,t),e.prototype.swapCloud=function(){this.cloud=new O(this.renderer.configs.width,this.renderer.configs.height-300,120,70),this.clouds.push(this.cloud)},e.prototype.swapObstacle=function(){0==this.random(0,2)?(this.brid=new _(this.renderer.configs.width+50,this.renderer.configs.height-200,120,70),this.obstacles.push(this.brid)):(this.cactus=new g(this.renderer.configs.width+50,this.renderer.configs.height-170,50,120),this.obstacles.push(this.cactus))},e.prototype.random=function(t,e){return Math.round(Math.random()*(e-t)+t)},e.prototype.update=function(t,e){this.renderer.ctx.clearRect(0,0,this.renderer.configs.width,this.renderer.configs.height),this.score++,this.scoreText.t="Score: "+this.score,this.score>this.highscore&&(this.highscore=this.score,this.highscoreText.t="Highscore: "+this.highscore),this.renderer.renderText(this.scoreText),this.renderer.renderText(this.highscoreText),this.spawnTimer--,this.spawnTimer<=0&&(this.swapCloud(),this.swapObstacle(),this.spawnTimer=this.initialSpawnTimer-12,this.spawnTimer<60&&(this.spawnTimer=60));for(var n=0;n<this.clouds.length;n++)(r=this.clouds[n]).x+r.w<0&&this.clouds.slice(n,1),r.update(),this.renderer.renderImage(r);for(n=0;n<this.obstacles.length;n++){var r;console.log(),(r=this.obstacles[n]).x+r.w<0&&(console.log(1),this.obstacles.splice(n,1)),console.log("---------------------"),console.log(this.player.x),console.log(this.player.w),console.log(r.w),console.log(this.player.x<r.x+r.w),this.player.x<r.x+r.w&&this.player.x+this.player.w>r.x&&this.player.y<r.y+r.h&&this.player.y+this.player.h>r.y&&(this.obstacles=[],this.score=0,this.spawnTimer=this.initialSpawnTimer,this.gameSpeed=10,u.currentScene=new H(this.configs)),r.update(),this.renderer.renderImage(r)}this.player.update(),this.renderer.renderImage(this.player),this.renderer.renderImage(this.ground)},e}(f),k=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(t){function e(e){var n=t.call(this,e)||this;return n.objectList=[],n.gameOverText=new j("Game Over",n.renderer.configs.height/2+10,n.renderer.configs.height/2-70),n.gameOverButton=new I(n.renderer.configs.width/2-50,n.renderer.configs.height/2-50,100,100),n.objectList.push(n.gameOverButton),n.objectList.push(n.gameOverText),n}return k(e,t),e.prototype.update=function(t,e){s.keys.Space&&(console.log("Space"),u.currentScene=new C(this.configs))},e}(f),B={canvasId:"game",width:innerWidth,height:innerHeight};new c(B),(new s).handleInput();var M=new a(B);console.log("Start"),M.addScene(new E(B)),M.addScene(new C(B)),M.addScene(new H(B)),M.start()})();