(()=>{"use strict";var t,o=function(){function t(){}return t.init=function(o){o.width=window.innerWidth,o.height=window.innerHeight,this.width=o.width,this.height=o.height,t.ctx=o.getContext("2d")},t}(),n=function(){function t(){}return t.prototype.handleInput=function(){document.addEventListener("keydown",(function(o){t.keys[o.code]=!0})),document.addEventListener("keyup",(function(o){t.keys[o.code]=!1}))},t.keys={},t}(),r=function(){function t(){}return t.prototype.addScene=function(o){t.scenes.push(o),1==t.scenes.length&&(t.currentScene=o)},t.prototype.findSceneIndex=function(o){return t.scenes.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(o)}))},t.scenes=[],t}(),e=function(){function t(){this.sceneManager=new r}return t.prototype.addScene=function(t){console.log("Game: addScene"),this.sceneManager.addScene(t)},t.prototype.start=function(){},t}(),i=(t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)},function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),c=function(t){function o(){return t.call(this)||this}return i(o,t),o.prototype.addScene=function(o){t.prototype.addScene.call(this,o)},o.prototype.start=function(){var t=this,o=window.performance.now(),n=window.performance.now()-this.lastTime;this.lastTime=o;var e=r.currentScene;e.update(o,n),e.draw(),requestAnimationFrame((function(){t.start()}))},o}(e),s=function(){function t(){}return t.prototype.update=function(t,o){},t.prototype.draw=function(){},t}(),u=function(t,o,n,r){this.x=t,this.y=o,this.w=n,this.h=r},a=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function n(o,n,r,e,i){var c=t.call(this,n,r,e,i)||this;return c.img=new Image,c.urlImg=o,c.img.src=o,c}return a(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.drawImage(this.img,this.x,this.y,this.w,this.h),o.ctx.closePath()},n.prototype.update=function(){},n}(u),h=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function r(o,n,r,e){var i=t.call(this,"./img/trex-1.png",o,n,r,e)||this;return i.image=new Image,i.originalHeight=i.h,i.originalWeight=i.w,i.grounded=!1,i.ground=54,i.jumpForce=15,i.jumpTimer=0,i.isBow=!1,i.dy=0,i.gravity=1,i}return h(r,t),r.prototype.draw=function(){o.ctx.beginPath(),0==this.isBow?(this.urlImg="./img/trex-1.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)):(this.urlImg="./img/trex-2.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)),o.ctx.closePath()},r.prototype.update=function(){n.keys.Space||n.keys.KeyW||n.keys.ArrowUp?this.jump():this.jumpTimer=0,n.keys.ArrowDown||n.keys.KeyS?(this.isBow=!0,this.h=3*this.originalHeight/4):(this.isBow=!1,this.h=this.originalHeight,this.w=this.originalWeight),this.y+=this.dy,this.y+this.h<o.height-this.ground?(this.dy+=this.gravity,this.grounded=!1):(this.dy=0,this.grounded=!0,this.y=o.height-this.h-this.ground),this.draw()},r.prototype.jump=function(){o.ctx.clearRect(this.x,this.y,this.w,this.h),this.grounded&&0==this.jumpTimer?(this.jumpTimer=1,this.dy=-this.jumpForce):this.jumpTimer>0&&this.jumpTimer<15&&(this.jumpTimer++,this.dy=-this.jumpForce-this.jumpTimer/50)},r}(p),f=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function o(o,n,r,e){var i=t.call(this,"./img/cactus.png",o,n,r,e)||this;return i.dx=-10,i}return f(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(p),w=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function o(o,n,r,e){var i=t.call(this,"./img/brid.png",o,n,r,e)||this;return i.dx=-10,i}return w(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(p),g=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(t){function o(o,n,r,e){var i=t.call(this,"./img/cloud.png",o,n,r,e)||this;return i.dx=-20,i}return g(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(p),m=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(t){function n(o,n,r,e,i,c){var s=t.call(this,n,r,0,0)||this;return s.t=o,s.a=e,s.c=i,s.s=c,s}return m(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.fillStyle=this.c,o.ctx.font=this.s+"px sans-serif",o.ctx.textAlign=this.a,o.ctx.fillText(this.t,this.x,this.y),o.ctx.closePath()},n}(u),O=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function o(o,n,r){return t.call(this,o,n,r,"left","#212121","20")||this}return O(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(x),b=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function o(o,n,r){return t.call(this,o,n,r,"center","black","30")||this}return b(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(x),j=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){function o(o,n,r,e){var i=t.call(this,"./img/ground.png",o,n,r,e)||this;return i.dx=-1,i}return j(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(p),P=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(t){function o(o,n,r,e){var i=t.call(this,"./img/gameOver.png",o,n,r,e)||this;return i.dx=-10,i}return P(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.draw()},o}(p),E=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(t){function e(){var n=t.call(this)||this;return n.startText=new S("PRESS SPACE TO START GAME",o.width/2+45,o.height/2-20),n.scoreText=new v("Score: 0",25,25),n.highscore=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new v("Highscore: "+n.highscore,o.width-200,25),n.player=new l(25,o.height-150,100,100),n.ground=new T(0,o.height-54,o.width,10),n}return E(e,t),e.prototype.draw=function(){o.ctx.clearRect(0,0,o.width,o.width),this.startText.draw(),this.scoreText.draw(),this.highscoreText.draw(),this.player.draw(),this.ground.draw()},e.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),r.currentScene=new k)},e}(s),C=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),k=function(t){function n(){var n=t.call(this)||this;return n.initialSpawnTimer=200,n.spawnTimer=n.initialSpawnTimer,n.isDead=!1,n.clouds=[],n.obstacles=[],n.scoreText=new v("Score: 0",25,25),n.highscore=0,n.score=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new v("Highscore: "+n.highscore,o.width-200,25),n.player=new l(25,o.height-150,100,100),n.ground=new T(0,o.height-54,o.width,10),n.cactus=new y(4e3,4e3,50,120),n.brid=new d(4e3,4e3,120,70),n.cloud=new _(4e3,2e3,120,70),n.gameSpeed=10,n}return C(n,t),n.prototype.draw=function(){o.ctx.clearRect(0,0,o.width,o.width),this.scoreText.draw(),this.highscoreText.draw(),this.player.draw(),this.ground.draw(),this.cactus.draw(),this.brid.draw(),this.cloud.draw()},n.prototype.swapCloud=function(){this.cloud=new _(o.width,o.height-300,120,70),this.clouds.push(this.cloud)},n.prototype.swapObstacle=function(){0==this.random(0,2)?(this.brid=new d(o.width+50,o.height-200,120,70),this.obstacles.push(this.brid)):(this.cactus=new y(o.width+50,o.height-170,50,120),this.obstacles.push(this.cactus))},n.prototype.random=function(t,o){return Math.round(Math.random()*(o-t)+t)},n.prototype.update=function(t,n){o.ctx.clearRect(0,0,o.width,o.height),this.score++,this.scoreText.t="Score: "+this.score,this.score>this.highscore&&(this.highscore=this.score,this.highscoreText.t="Highscore: "+this.highscore),this.scoreText.draw(),this.highscoreText.draw(),this.spawnTimer--,this.spawnTimer<=0&&(this.swapCloud(),this.swapObstacle(),this.spawnTimer=this.initialSpawnTimer-12,this.spawnTimer<60&&(this.spawnTimer=60));for(var e=0;e<this.clouds.length;e++)(i=this.clouds[e]).x+i.w<0&&this.clouds.slice(e,1),i.update();for(e=0;e<this.obstacles.length;e++){var i;console.log(),(i=this.obstacles[e]).x+i.w<0&&(console.log(1),this.obstacles.splice(e,1)),console.log("---------------------"),console.log(this.player.x),console.log(this.player.w),console.log(i.w),console.log(this.player.x<i.x+i.w),this.player.x<i.x+i.w&&this.player.x+this.player.w>i.x&&this.player.y<i.y+i.h&&this.player.y+this.player.h>i.y&&(this.obstacles=[],this.score=0,this.spawnTimer=this.initialSpawnTimer,this.gameSpeed=10,r.currentScene=new H),i.update()}this.player.update()},n}(s),B=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(t){function e(){var n=t.call(this)||this;return n.gameOverText=new S("Game Over",o.width/2+10,o.height/2-70),n.gameOverButton=new A(o.width/2-50,o.height/2-50,100,100),n}return B(e,t),e.prototype.draw=function(){this.gameOverButton.draw(),this.gameOverText.draw()},e.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),r.currentScene=new k)},e}(s);o.init(document.getElementById("game")),(new n).handleInput();var R=new c;console.log("Start"),R.addScene(new I),R.addScene(new k),R.addScene(new H),R.start()})();