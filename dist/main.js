(()=>{"use strict";var t,o=function(){function t(){}return t.init=function(o){o.width=window.innerWidth,o.height=window.innerHeight,this.width=o.width,this.height=o.height,t.ctx=o.getContext("2d")},t}(),n=function(){function t(){}return t.prototype.handleInput=function(){document.addEventListener("keydown",(function(o){t.keys[o.code]=!0})),document.addEventListener("keyup",(function(o){t.keys[o.code]=!1}))},t.keys={},t}(),e=function(){function t(){}return t.prototype.addScene=function(o){t.scenes.push(o),1==t.scenes.length&&(t.currentScene=o)},t.prototype.findSceneIndex=function(o){return t.scenes.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(o)}))},t.scenes=[],t}(),r=function(){function t(){this.sceneManager=new e}return t.prototype.addScene=function(t){console.log("Game: addScene"),this.sceneManager.addScene(t)},t.prototype.start=function(){var t=this,o=window.performance.now(),n=window.performance.now()-this.lastTime;this.lastTime=o;var r=e.currentScene;r.update(o,n),r.draw(),requestAnimationFrame((function(){t.start()}))},t}(),i=function(){function t(){}return t.prototype.update=function(t,o){},t.prototype.draw=function(){},t}(),c=function(t,o,n,e){this.x=t,this.y=o,this.w=n,this.h=e},s=(t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)},function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),u=function(t){function n(o,n,e,r,i){var c=t.call(this,n,e,r,i)||this;return c.img=new Image,c.urlImg=o,c.img.src=o,c}return s(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.drawImage(this.img,this.x,this.y,this.w,this.h),o.ctx.closePath()},n.prototype.update=function(){},n}(c),a=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),h=function(t){function e(o,n,e,r){var i=t.call(this,"./img/trex-1.png",o,n,e,r)||this;return i.image=new Image,i.originalHeight=i.h,i.originalWeight=i.w,i.grounded=!1,i.ground=54,i.jumpForce=15,i.jumpTimer=0,i.isBow=!1,i.dy=0,i.gravity=1,i}return a(e,t),e.prototype.draw=function(){o.ctx.beginPath(),0==this.isBow?(this.urlImg="./img/trex-1.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)):(this.urlImg="./img/trex-2.png",this.image.src=this.urlImg,o.ctx.drawImage(this.image,this.x,this.y,this.w,this.h)),o.ctx.closePath()},e.prototype.update=function(){n.keys.Space||n.keys.KeyW||n.keys.ArrowUp?this.jump():this.jumpTimer=0,n.keys.ArrowDown||n.keys.KeyS?(this.isBow=!0,this.h=3*this.originalHeight/4):(this.isBow=!1,this.h=this.originalHeight,this.w=this.originalWeight),this.y+=this.dy,this.y+this.h<o.height-this.ground?(this.dy+=this.gravity,this.grounded=!1):(this.dy=0,this.grounded=!0,this.y=o.height-this.h-this.ground),this.draw()},e.prototype.jump=function(){o.ctx.clearRect(this.x,this.y,this.w,this.h),this.grounded&&0==this.jumpTimer?(this.jumpTimer=1,this.dy=-this.jumpForce):this.jumpTimer>0&&this.jumpTimer<15&&(this.jumpTimer++,this.dy=-this.jumpForce-this.jumpTimer/50)},e}(u),p=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),l=function(t){function o(o,n,e,r){var i=t.call(this,"./img/cactus.png",o,n,e,r)||this;return i.dx=-10,i}return p(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(u),f=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),y=function(t){function o(o,n,e,r){var i=t.call(this,"./img/brid.png",o,n,e,r)||this;return i.dx=-10,i}return f(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(u),w=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),d=function(t){function o(o,n,e,r){var i=t.call(this,"./img/cloud.png",o,n,e,r)||this;return i.dx=-20,i}return w(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(u),g=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),_=function(t){function n(o,n,e,r,i,c){var s=t.call(this,n,e,0,0)||this;return s.t=o,s.a=r,s.c=i,s.s=c,s}return g(n,t),n.prototype.draw=function(){o.ctx.beginPath(),o.ctx.fillStyle=this.c,o.ctx.font=this.s+"px sans-serif",o.ctx.textAlign=this.a,o.ctx.fillText(this.t,this.x,this.y),o.ctx.closePath()},n}(c),m=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),x=function(t){function o(o,n,e){return t.call(this,o,n,e,"left","#212121","20")||this}return m(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(_),O=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),v=function(t){function o(o,n,e){return t.call(this,o,n,e,"center","black","30")||this}return O(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o}(_),b=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),T=function(t){function o(o,n,e,r){var i=t.call(this,"./img/ground.png",o,n,e,r)||this;return i.dx=-1,i}return b(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.x+=this.dx,this.draw()},o}(u),S=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),j=function(t){function o(o,n,e,r){var i=t.call(this,"./img/gameOver.png",o,n,e,r)||this;return i.dx=-10,i}return S(o,t),o.prototype.draw=function(){t.prototype.draw.call(this)},o.prototype.update=function(){this.draw()},o}(u),P=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),A=function(t){function r(){var n=t.call(this)||this;return n.startText=new v("PRESS SPACE TO START GAME",o.width/2+45,o.height/2-20),n.scoreText=new x("Score: 0",25,25),n.highscore=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new x("Highscore: "+n.highscore,o.width-200,25),n.player=new h(25,o.height-150,100,100),n.ground=new T(0,o.height-54,o.width,10),n}return P(r,t),r.prototype.draw=function(){o.ctx.clearRect(0,0,o.width,o.width),this.startText.draw(),this.scoreText.draw(),this.highscoreText.draw(),this.player.draw(),this.ground.draw()},r.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),e.currentScene=new I)},r}(i),E=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),I=function(t){function n(){var n=t.call(this)||this;return n.initialSpawnTimer=200,n.spawnTimer=n.initialSpawnTimer,n.isDead=!1,n.clouds=[],n.obstacles=[],n.scoreText=new x("Score: 0",25,25),n.highscore=0,n.score=0,localStorage.getItem("highscore")&&(n.highscore=Number(localStorage.getItem("highscore"))),n.highscoreText=new x("Highscore: "+n.highscore,o.width-200,25),n.player=new h(25,o.height-150,100,100),n.ground=new T(0,o.height-54,o.width,10),n.cactus=new l(4e3,4e3,50,120),n.brid=new y(4e3,4e3,120,70),n.cloud=new d(4e3,2e3,120,70),n.gameSpeed=10,n}return E(n,t),n.prototype.draw=function(){o.ctx.clearRect(0,0,o.width,o.width),this.scoreText.draw(),this.highscoreText.draw(),this.player.draw(),this.ground.draw(),this.cactus.draw(),this.brid.draw(),this.cloud.draw()},n.prototype.swapCloud=function(){this.cloud=new d(o.width,o.height-300,120,70),this.clouds.push(this.cloud)},n.prototype.swapObstacle=function(){0==this.random(0,2)?(this.brid=new y(o.width+50,o.height-200,120,70),this.obstacles.push(this.brid)):(this.cactus=new l(o.width+50,o.height-170,50,120),this.obstacles.push(this.cactus))},n.prototype.random=function(t,o){return Math.round(Math.random()*(o-t)+t)},n.prototype.update=function(t,n){o.ctx.clearRect(0,0,o.width,o.height),this.score++,this.scoreText.t="Score: "+this.score,this.score>this.highscore&&(this.highscore=this.score,this.highscoreText.t="Highscore: "+this.highscore),this.scoreText.draw(),this.highscoreText.draw(),this.spawnTimer--,this.spawnTimer<=0&&(this.swapCloud(),this.swapObstacle(),this.spawnTimer=this.initialSpawnTimer-12,this.spawnTimer<60&&(this.spawnTimer=60));for(var r=0;r<this.clouds.length;r++)(i=this.clouds[r]).x+i.w<0&&this.clouds.slice(r,1),i.update();for(r=0;r<this.obstacles.length;r++){var i;console.log(),(i=this.obstacles[r]).x+i.w<0&&(console.log(1),this.obstacles.splice(r,1)),console.log("---------------------"),console.log(this.player.x),console.log(this.player.w),console.log(i.w),console.log(this.player.x<i.x+i.w),this.player.x<i.x+i.w&&this.player.x+this.player.w>i.x&&this.player.y<i.y+i.h&&this.player.y+this.player.h>i.y&&(this.obstacles=[],this.score=0,this.spawnTimer=this.initialSpawnTimer,this.gameSpeed=10,e.currentScene=new k),i.update()}this.player.update()},n}(i),C=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),k=function(t){function r(){var n=t.call(this)||this;return n.gameOverText=new v("Game Over",o.width/2+10,o.height/2-70),n.gameOverButton=new j(o.width/2-50,o.height/2-50,100,100),n}return C(r,t),r.prototype.draw=function(){this.gameOverButton.draw(),this.gameOverText.draw()},r.prototype.update=function(t,o){n.keys.Space&&(console.log("Space"),e.currentScene=new I)},r}(i);o.init(document.getElementById("game")),(new n).handleInput();var B=new r;console.log("Start"),B.addScene(new A),B.addScene(new I),B.addScene(new k),B.start()})();